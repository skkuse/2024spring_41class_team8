 
<!DOCTYPE html>
 
<html>
    <head>
        <meta http-equiv="Content-Type"content="width=device-width, initial-scale=1.0" charset="UTF-8"> 
        <style>
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body{ font-family: Arial, sans-serif;    width:100%; height:100%;    margin:0px;    overflow-x:hidden; }
            article, header, nav, section, div{ display: block;}
            body, button, input, table{     font-size: 12px;}
            .head_logo{margin:0;    margin-bottom:3px;}
            .head_logo_wrap{ border-bottom:4px solid #83acaf; margin-bottom: 0;height:150px;padding:10px ; padding-top:0; padding-bottom:0;   background-color:#c8e2df ; padding-left:10%; font-size: 30px; display:flex;padding-left:15%;}
            .head_logo_box{ margin-top:30px; display:inline-block; margin-left:30px;}
            #icon{margin-top:15px;    display:inline-block;}
            .navigation{  margin-top:0; min-width:1200px;    background-color: #c8e2df;  padding-left: 15%;  position:relative;height: 45px;}
            .navbar{    width:auto;    height: auto;}
            .nav-list{    width:800px;    height: fit-content;    background:transparent;    list-style:none;   display:block;}
            a{    text-decoration:none;}
            .nav-link{    color: rgb(68, 134, 119);    font-size:14px;    font-weight: bold;    line-height: 40px;}
            .nav-item{    display: list-item;    position:relative;    float:left;    margin-right: 50px;  margin-left:5px;   padding: 0;    border: 0;}
            .wrap-inner{    position: relative;    width: 100%;    display: flex;    flex-direction: column; align-items: center; justify-content: center; margin-top: 30px;   margin: 0;}
            .write-head{    margin-left : 15%;    font-size : 15px;}
            .content-section{ width: 80%; background: #fff; display: block; padding-top : 30px;margin:auto;}
            .content-options{    display: table;    margin:15px;}
            .write-section{    display: block;    margin: auto;}
            .write-form{    display: flex;    flex-direction: column;}
            .write-box{    margin-bottom: 15px;            padding: 10px;            font-size: 16px;}
            .submit{width:66px;height:30px; box-sizing: border-box; margin-left:88%; border: none;  
                font-size: 12px; line-height: 19px;vertical-align: top;text-align: center;background-color:  #d3e2e1; border-radius:5px;display: inline-block;text-decoration: none;}
            .right-box{    position: relative;    z-index: 1;    float:right;    min-width:90px;    height:30px;    width: max-content;    vertical-align: top;    padding-top : 10px;    margin:0;    border:0;}
            #btn_write{    width:66px;    height:30px;    box-sizing: border-box;    padding: 0px 6px;    border: 1px solid #333;    font-weight: bold;    font-size: 12px;    line-height: 19px;    vertical-align: top;
                text-align: center;    background-color: #fff;    display: inline-block;    text-decoration: none;}
            .content-list-wrap{    position: relative;    margin:0;    padding: 0;    border: 0;    border-top: 1px solid #333;    vertical-align: baseline;    font-style: normal;    font-size: 12px;}
            .content-list{    width:100%;    border-bottom: 1px solid #111;    border-collapse: collapse;    border-spacing: 0;    table-layout: fixed;    margin: 0;    padding: 0;    vertical-align: baseline;    display: table;}
            thead{    margin:0;    padding: 0;    border: 0;    vertical-align: baseline;    font-style: normal;}
            tr{    display: table-row;}
            th{    display: table-cell;    font-weight: bold;    margin: 0;    border: 0;    padding: 0;}
            .list{    display: table-row-group;    margin: 0;    padding: 0;    border: 0;    vertical-align: baseline;    font-style: normal;}
            .content{    display: table-row;    width: 100%;}
            td{    padding-top:1px;    height:30px;    border-top:1px solid #bbb;    vertical-align: middle;    text-align: center;    color:#333;    display: table-cell;}
            .listbottom_box{    margin-top:15px;    padding:0;    border:0;    margin-right:15px;    display: block;}
            .listbottom_box:after{    clear: both;    display: block;    visibility: hidden;    content: "";}
            .writebottom_box{    float: right;}
            .bottom-paging-wrap{    display: inline-block;    margin-left: 45%;    margin-bottom: 15px;   width: 100%;    margin-top: 5px;    position: relative;  padding: 0 100px; box-sizing: border-box;}
            em{    padding-top:6px;    color: #d31900;    text-decoration: underline;    font-size: 14px;    font-weight: bold;    display: inline-block;}
            .paging-list-num{    padding-top:6px; display: inline-block; margin-left: 9px;font-size: 14px;  font-weight: bold; color: #333; text-decoration: none;}
            form{    display: block;    font-size: 12px; margin: 0; padding: 0; border: 0; font-style: normal;}
            .search_wrap{ margin: 20px; position: relative; height: fit-content; display: flex; width: 700px; padding: 0;}
            .search_select_box{ width: 100px; height: 35px; border: 1px solid #80d100; position: relative; display: inline-block;}
            select{ width:100%; height: 100%; border:0; border-radius: 0; vertical-align: middle; font-size: 12px; text-rendering: auto; letter-spacing: normal;text-align: start;}
            .search_input_box{ width: 450px; height: 35px; margin-left: 5px; border: 1px solid #333;display: inline-block;}
            .search_input{ margin: 3px 0 0 3px; width: 300px; float: left; background: #fff; padding: 0;}
            .input_word{ width: 300px; height: 30px; padding: 0 9px; border: none; color: #333; font-size: 14px; font-weight: bold; vertical-align: middle;}
            input[type="text" i] { padding-block: 1px; padding-inline: 2px;}
            .search_btn{ width: 40px; height: 35px; float: right; background-color: #fff; border: 1px solid #333;}
            .post-container {width: 65%; max-width: 800px; margin-left:10%; margin-top:20px; }
            .back-button_wrap{width:65%;display:flex; margin-left:10%; border-bottom:2px solid #bbb}
            .back-button{width:75px;align-self: flex-start; margin-bottom: 10px; padding: 10px 10px; text-align:center; font-size: 1em; cursor: pointer;background-color: #bbb; color: #333; font-weight:bold;border: none;border-radius: 5px;text-decoration: none;}
            .footer{background-color: #5b7772 ; height:250px; width:100%; align-items:center;display:flex;}
            .post-title{font-size: 2em;margin-bottom: 20px;}
            .post-meta{display: flex; justify-content: space-between; font-size: 0.9em; color:#bbbbbb; margin-bottom: 20px;}
            .post-content{min-height: 130px; font-size:15px; line-height: 1.6; white-space: pre-line; margin-bottom:20px;}
            .comment-section{width:100%; margin-top: 30px;margin-bottom:80px;}
            .comment-form{display: flex; flex-direction: column; margin-bottom: 20px;}
            .comment-form textarea{padding:10px;font-size:1em; margin-bottom: 10px;}
            .comment-form button{ font-size:1em;cursor:pointer;}
            .comments{list-style-type: none; padding:0;}
            .comment{border-bottom:1px solid #444;padding: 10px 0;}
            .suggest-button {display: block;  width: 100%; max-width: 200px; padding: 10px; font-weight:bold;font-size: 1em; cursor: pointer;background-color:  #d3e2e1;color: #333;border: none;border-radius: 5px;margin: 20px auto;}
            .modify-section { display: flex;justify-content: center; margin-top: 30px;}
            .modify-section input {margin-right: 10px;padding: 10px;font-size: 1em;}
            .modify-section button {padding: 10px;font-size: 1em;cursor: pointer;background-color:  #d3e2e1; color: #333;border: none;border-radius: 5px;}
            .footer{background-color: #5b7772 ; height:250px; width:100%; align-items:center;display:flex;}
            #footer-team{margin-top:30px;margin-left: 15%;width:20%;font-size: 15px; color:#d6d6d6; font-style:italic;}
            #icon-1{margin-top:15px;  padding-top:15px; display:inline-block;}
        </style>
        <title>Eco Master 커뮤니티</title>
    </head>
    <body>
        <header class="head">
            <div class="head_logo_wrap">
                <div id="icon"> <img src="/html_template/Preview.png" width="200px" height="120px"></div>
            </div>
        </header>
        <div class="navigation">
            <nav class="navbar"> 
                <ul class="nav-list">
                    <li class="nav-item"><a class="nav-link" href="">Code</a></li>
                    <li class="nav-item"><a class="nav-link" href="">Green Quiz</a></li>    
                    <li class="nav-item"><a class="nav-link" href="/community">Community</a></li>
                </ul>
            </nav>
        </div>
        <div class="wrap_inner">
            <section class="content-section">
                <div class="back-button_wrap">
                    <a href="/community" class="back-button">돌아가기</a>
                </div>
                <div class="post-container">
                    <div class="post-title">{{ post.title }}</div>
                    <div class="post-meta">
                        <div>조회수: {{ post.views }}</div>
                        <div>{{ post.postdate }}</div>
                    </div>
                    <div class="post-content">{{ post.detail }}</div>
                    <button id="suggest-button" class="suggest-button" onclick="suggestPost()">추천 ({{ post.suggest }})</button>
                    <div class="modify-section">
                        <input type="password" id="modify-password" placeholder="비밀번호 입력" required>
                        <button onclick="modifyPost('{{ post.id }}')">수정</button>
                    </div>
                    <div class="comment-section">
                        <h2 style="margin-bottom:15px;">댓글 ({{ comments|length }})</h2>
                        <form class="comment-form" action="/post/{{ post.id }}/comments" method="post">
                            <textarea name="comment" rows="4" placeholder="댓글을 입력하세요..." required></textarea>
                            <button class="submit" type="submit">작성</button>
                        </form>
                        <ul class="comments">
                            {% for comment in comments %}
                            <li class="comment">
                                <div style="font-size:13px;">└&nbsp;&nbsp;{{ comment.content }}</div>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
    <script>
        function suggestPost() {
            fetch(`/post/{{ post.id }}/suggest`, {
                method: 'POST',
            })
            .then(response => response.json().then(data => ({status: response.status, body: data})))
            .then(({status, body}) => {
                if (status === 200) {
                    document.getElementById('suggest-button').innerText = `추천 (${body.suggest})`;
                } else {
                    alert(body.detail || '추천에 실패했습니다.');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('추천에 실패했습니다.');
            });
        }

        function modifyPost(postId) {
            const password = document.getElementById('modify-password').value;
            fetch(`/post/${postId}/check_password`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ password: password })
            })
            .then(response => response.json().then(data => ({status: response.status, body: data})))
            .then(({status, body}) => {
                if (status === 200) {
                    const post = body.post;
                    const params = new URLSearchParams({
                        postnumber: postId,
                        title: post.title,
                        category: post.category,
                        content: post.content,
                        password: password
                    }).toString();
                    window.location.href = `/modify_post?${params}`;
                } else {
                    alert(body.detail || '비밀번호가 일치하지 않습니다.');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('비밀번호가 일치하지 않습니다.');
            });
        }
    </script>    
                    </div>
                
                </article>
            </section>
        </div>
        <footer class="footer">
            
            <div id="footer-team">
                <div>Eco Master&nbsp;&nbsp;| &nbsp; Sungkyunkwan University <br>
                    Software Engineering&nbsp; | &nbsp;Team 8<br>
                    <div id="icon"> <img src="/html_template/Preview.png" width="100px" height="60px"></div>
                </div>
                
            </div>
            <div id="icon-1"><img src="/html_template/earth_good.png" width="100px" height="100px"></div>       
        </footer>
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
        <script src="js/bootstrap.js"></script>
    </body>
</html>
